{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  data() {\n    return {\n      userList: [],\n      dialogVisible: false,\n      userForm: {\n        userName: '',\n        roleList: []\n      },\n      editIndex: null // null为新增，否则为编辑\n    };\n  },\n  methods: {\n    getTagType(xinfa) {\n      if (xinfa === 'T') return 'danger';\n      if (xinfa === '奶') return 'success';\n      return '';\n    },\n    openDialog() {\n      this.editIndex = null;\n      this.userForm = {\n        userName: '',\n        roleList: []\n      };\n      this.dialogVisible = true;\n    },\n    editUser(index) {\n      this.editIndex = index;\n      // 深拷贝，避免直接修改原数据\n      this.userForm = JSON.parse(JSON.stringify(this.userList[index]));\n      this.dialogVisible = true;\n    },\n    removeUser(index) {\n      this.$confirm('确定删除该玩家及其角色？', '提示', {\n        type: 'warning'\n      }).then(() => {\n        this.userList.splice(index, 1);\n      });\n    },\n    addRole() {\n      if (this.userForm.roleList.length >= 3) return;\n      this.userForm.roleList.push({\n        roleName: '',\n        xinfa: ''\n      });\n    },\n    removeRole(idx) {\n      this.userForm.roleList.splice(idx, 1);\n    },\n    handleClose() {\n      this.dialogVisible = false;\n    },\n    onSave() {\n      if (!this.userForm.userName) {\n        this.$message.warning('请输入玩家名');\n        return;\n      }\n      if (this.userForm.roleList.length === 0) {\n        this.$message.warning('请至少添加一个角色');\n        return;\n      }\n      for (const role of this.userForm.roleList) {\n        if (!role.roleName || !role.xinfa) {\n          this.$message.warning('请完善角色信息');\n          return;\n        }\n      }\n      if (this.editIndex === null) {\n        this.userList.push(JSON.parse(JSON.stringify(this.userForm)));\n      } else {\n        this.$set(this.userList, this.editIndex, JSON.parse(JSON.stringify(this.userForm)));\n      }\n      this.dialogVisible = false;\n    }\n  }\n};","map":{"version":3,"names":["data","userList","dialogVisible","userForm","userName","roleList","editIndex","methods","getTagType","xinfa","openDialog","editUser","index","JSON","parse","stringify","removeUser","$confirm","type","then","splice","addRole","length","push","roleName","removeRole","idx","handleClose","onSave","$message","warning","role","$set"],"sources":["src/modules/jx3/role-draw.vue"],"sourcesContent":["<template>\n  <div class=\"jx3-draw\">\n    <div class=\"left\">\n      <p>角色池</p>\n      <div class=\"user-list\" v-for=\"(user, index) in userList\" :key=\"user.userName + index\">\n        <div class=\"name\">{{ user.userName }}：</div>\n        <div class=\"role\">\n          <el-tag\n            v-for=\"(role, _index) in user.roleList\"\n            :key=\"'role' + _index\"\n            size=\"small\"\n            :type=\"getTagType(role.xinfa)\"\n          >\n            {{ role.roleName }}（{{ role.xinfa }}）\n          </el-tag>\n        </div>\n        <el-button size=\"mini\" @click=\"editUser(index)\">编辑</el-button>\n        <el-button size=\"mini\" type=\"danger\" @click=\"removeUser(index)\">删除</el-button>\n      </div>\n      <div class=\"add-btn\">\n        <el-button style=\"width: 200px;margin-left: 50px;\" size=\"mini\"\n          @click=\"openDialog()\">添加玩家</el-button>\n      </div>\n    </div>\n    <div class=\"right\">\n      <!-- 这里后续放抽签扭蛋机部分 -->\n    </div>\n    <!-- 添加/编辑玩家弹窗 -->\n    <el-dialog :title=\"editIndex === null ? '添加玩家' : '编辑玩家'\" :visible.sync=\"dialogVisible\" width=\"500px\" :before-close=\"handleClose\">\n      <el-form :model=\"userForm\" label-width=\"70px\">\n        <el-form-item label=\"玩家\">\n          <el-input v-model=\"userForm.userName\" size=\"mini\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"角色\">\n          <div v-for=\"(role, idx) in userForm.roleList\" :key=\"'formrole' + idx\" style=\"margin-bottom: 8px;\">\n            <el-input v-model=\"role.roleName\" size=\"mini\" placeholder=\"角色名\" style=\"width: 120px; margin-right: 8px;\" />\n            <el-select v-model=\"role.xinfa\" size=\"mini\" placeholder=\"心法\" style=\"width: 80px;\">\n              <el-option label=\"T\" value=\"T\"></el-option>\n              <el-option label=\"奶\" value=\"奶\"></el-option>\n              <el-option label=\"DPS\" value=\"DPS\"></el-option>\n            </el-select>\n            <el-button size=\"mini\" type=\"danger\" icon=\"el-icon-delete\" @click=\"removeRole(idx)\" />\n          </div>\n          <el-button\n            v-if=\"userForm.roleList.length < 3\"\n            class=\"button-new-tag\"\n            size=\"mini\"\n            @click=\"addRole\"\n            style=\"margin-top: 8px;\"\n          >+ 添加角色</el-button>\n        </el-form-item>\n      </el-form>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\" size=\"mini\">取消</el-button>\n        <el-button type=\"primary\" @click=\"onSave\" size=\"mini\">确定</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      userList: [],\n      dialogVisible: false,\n      userForm: {\n        userName: '',\n        roleList: []\n      },\n      editIndex: null // null为新增，否则为编辑\n    }\n  },\n  methods: {\n    getTagType(xinfa) {\n      if (xinfa === 'T') return 'danger'\n      if (xinfa === '奶') return 'success'\n      return ''\n    },\n    openDialog() {\n      this.editIndex = null\n      this.userForm = { userName: '', roleList: [] }\n      this.dialogVisible = true\n    },\n    editUser(index) {\n      this.editIndex = index\n      // 深拷贝，避免直接修改原数据\n      this.userForm = JSON.parse(JSON.stringify(this.userList[index]))\n      this.dialogVisible = true\n    },\n    removeUser(index) {\n      this.$confirm('确定删除该玩家及其角色？', '提示', {\n        type: 'warning'\n      }).then(() => {\n        this.userList.splice(index, 1)\n      })\n    },\n    addRole() {\n      if (this.userForm.roleList.length >= 3) return\n      this.userForm.roleList.push({ roleName: '', xinfa: '' })\n    },\n    removeRole(idx) {\n      this.userForm.roleList.splice(idx, 1)\n    },\n    handleClose() {\n      this.dialogVisible = false\n    },\n    onSave() {\n      if (!this.userForm.userName) {\n        this.$message.warning('请输入玩家名')\n        return\n      }\n      if (this.userForm.roleList.length === 0) {\n        this.$message.warning('请至少添加一个角色')\n        return\n      }\n      for (const role of this.userForm.roleList) {\n        if (!role.roleName || !role.xinfa) {\n          this.$message.warning('请完善角色信息')\n          return\n        }\n      }\n      if (this.editIndex === null) {\n        this.userList.push(JSON.parse(JSON.stringify(this.userForm)))\n      } else {\n        this.$set(this.userList, this.editIndex, JSON.parse(JSON.stringify(this.userForm)))\n      }\n      this.dialogVisible = false\n    }\n  }\n}\n</script>"],"mappings":";AA6DA;EACAA,KAAA;IACA;MACAC,QAAA;MACAC,aAAA;MACAC,QAAA;QACAC,QAAA;QACAC,QAAA;MACA;MACAC,SAAA;IACA;EACA;EACAC,OAAA;IACAC,WAAAC,KAAA;MACA,IAAAA,KAAA;MACA,IAAAA,KAAA;MACA;IACA;IACAC,WAAA;MACA,KAAAJ,SAAA;MACA,KAAAH,QAAA;QAAAC,QAAA;QAAAC,QAAA;MAAA;MACA,KAAAH,aAAA;IACA;IACAS,SAAAC,KAAA;MACA,KAAAN,SAAA,GAAAM,KAAA;MACA;MACA,KAAAT,QAAA,GAAAU,IAAA,CAAAC,KAAA,CAAAD,IAAA,CAAAE,SAAA,MAAAd,QAAA,CAAAW,KAAA;MACA,KAAAV,aAAA;IACA;IACAc,WAAAJ,KAAA;MACA,KAAAK,QAAA;QACAC,IAAA;MACA,GAAAC,IAAA;QACA,KAAAlB,QAAA,CAAAmB,MAAA,CAAAR,KAAA;MACA;IACA;IACAS,QAAA;MACA,SAAAlB,QAAA,CAAAE,QAAA,CAAAiB,MAAA;MACA,KAAAnB,QAAA,CAAAE,QAAA,CAAAkB,IAAA;QAAAC,QAAA;QAAAf,KAAA;MAAA;IACA;IACAgB,WAAAC,GAAA;MACA,KAAAvB,QAAA,CAAAE,QAAA,CAAAe,MAAA,CAAAM,GAAA;IACA;IACAC,YAAA;MACA,KAAAzB,aAAA;IACA;IACA0B,OAAA;MACA,UAAAzB,QAAA,CAAAC,QAAA;QACA,KAAAyB,QAAA,CAAAC,OAAA;QACA;MACA;MACA,SAAA3B,QAAA,CAAAE,QAAA,CAAAiB,MAAA;QACA,KAAAO,QAAA,CAAAC,OAAA;QACA;MACA;MACA,WAAAC,IAAA,SAAA5B,QAAA,CAAAE,QAAA;QACA,KAAA0B,IAAA,CAAAP,QAAA,KAAAO,IAAA,CAAAtB,KAAA;UACA,KAAAoB,QAAA,CAAAC,OAAA;UACA;QACA;MACA;MACA,SAAAxB,SAAA;QACA,KAAAL,QAAA,CAAAsB,IAAA,CAAAV,IAAA,CAAAC,KAAA,CAAAD,IAAA,CAAAE,SAAA,MAAAZ,QAAA;MACA;QACA,KAAA6B,IAAA,MAAA/B,QAAA,OAAAK,SAAA,EAAAO,IAAA,CAAAC,KAAA,CAAAD,IAAA,CAAAE,SAAA,MAAAZ,QAAA;MACA;MACA,KAAAD,aAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}